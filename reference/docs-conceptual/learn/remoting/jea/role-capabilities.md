---
ms.date: 07/10/2019
keywords: jea, PowerShell, biztonság
title: JEA szerepkör-képességek
ms.openlocfilehash: 7191b90e198ffb539da6870a8ddc3e449ad9e8ae
ms.sourcegitcommit: e894ed833cef57967cdaf002f8c883f66864e836
ms.translationtype: MT
ms.contentlocale: hu-HU
ms.lasthandoff: 08/25/2019
ms.locfileid: "70017957"
---
# <a name="jea-role-capabilities"></a><span data-ttu-id="b0b8d-103">JEA szerepkör-képességek</span><span class="sxs-lookup"><span data-stu-id="b0b8d-103">JEA Role Capabilities</span></span>

<span data-ttu-id="b0b8d-104">JEA-végpont létrehozásakor meg kell adnia egy vagy több szerepkör-funkciót, amely leírja, hogy mit tehet valaki egy JEA-munkamenetben.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-104">When creating a JEA endpoint, you need to define one or more role capabilities that describe what someone can do in a JEA session.</span></span> <span data-ttu-id="b0b8d-105">A szerepkör-képesség egy PowerShell-adatfájl, `.psrc` amely tartalmazza az összes olyan parancsmagot, funkciót, szolgáltatót és külső programot, amelyet a felhasználók összekapcsolásához elérhetővé tettek.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-105">A role capability is a PowerShell data file with the `.psrc` extension that lists all the cmdlets, functions, providers, and external programs that are made available to connecting users.</span></span>

## <a name="determine-which-commands-to-allow"></a><span data-ttu-id="b0b8d-106">Az engedélyezni kívánt parancsok meghatározása</span><span class="sxs-lookup"><span data-stu-id="b0b8d-106">Determine which commands to allow</span></span>

<span data-ttu-id="b0b8d-107">A szerepkör-képesség fájl létrehozásának első lépéseként meg kell fontolni, hogy mire van szükségük a felhasználóknak a használatához.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-107">The first step in creating a role capability file is to consider what the users need access to.</span></span> <span data-ttu-id="b0b8d-108">A követelmények gyűjtésének folyamata eltarthat egy ideig, de ez egy fontos folyamat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-108">The requirements gathering process can take a while, but it's an important process.</span></span> <span data-ttu-id="b0b8d-109">Ahhoz, hogy a felhasználók a túl kevés parancsmaghoz és funkcióhoz hozzáférjenek, meggátolhatja a feladatok elvégzését.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-109">Giving users access to too few cmdlets and functions can prevent them from getting their job done.</span></span> <span data-ttu-id="b0b8d-110">A túl sok parancsmaghoz és funkcióhoz való hozzáférés engedélyezése lehetővé teszi a felhasználók számára, hogy a kívántnál nagyobb mennyiségű, és gyengítse a biztonsági irányvonalat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-110">Allowing access to too many cmdlets and functions can allow users to do more than you intended and weaken your security stance.</span></span>

<span data-ttu-id="b0b8d-111">A folyamat menete a szervezettől és a céloktól függ.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-111">How you go about this process depends on your organization and goals.</span></span> <span data-ttu-id="b0b8d-112">A következő tippek segíthetnek a megfelelő elérési úton.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-112">The following tips can help ensure you're on the right path.</span></span>

1. <span data-ttu-id="b0b8d-113">**Azonosítsa azokat** a parancsokat, amelyeket a felhasználók a feladatok elvégzéséhez használnak.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-113">**Identify** the commands users are using to get their jobs done.</span></span> <span data-ttu-id="b0b8d-114">Ez magában foglalhatja az informatikai munkatársak felmérését, az automatizálási parancsfájlok ellenőrzését, illetve a PowerShell-munkamenetek átiratának és naplófájljainak elemzését.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-114">This may involve surveying IT staff, checking automation scripts, or analyzing PowerShell session transcripts and logs.</span></span>
2. <span data-ttu-id="b0b8d-115">A legjobb naplózási és JEA testreszabási élmény érdekében **frissítse** a parancssori eszközök használatát a PowerShell-lel egyenértékűként.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-115">**Update** use of command-line tools to PowerShell equivalents, where possible, for the best auditing and JEA customization experience.</span></span> <span data-ttu-id="b0b8d-116">A külső programok nem állíthatók be részletesen a JEA natív PowerShell-parancsmagjai és funkciói.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-116">External programs can't be constrained as granularly as native PowerShell cmdlets and functions in JEA.</span></span>
3. <span data-ttu-id="b0b8d-117">**Korlátozza** a parancsmagok hatókörét, hogy csak bizonyos paramétereket vagy paramétereket engedélyezzen.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-117">**Restrict** the scope of the cmdlets to only allow specific parameters or parameter values.</span></span> <span data-ttu-id="b0b8d-118">Ez különösen akkor fontos, ha a felhasználóknak csak a rendszer egy részét kell kezelnie.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-118">This is especially important if users should manage only part of a system.</span></span>
4. <span data-ttu-id="b0b8d-119">**Hozzon létre** egyéni függvényeket a JEA-ben nehéznek bizonyuló összetett parancsok vagy parancsok cseréjéhez.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-119">**Create** custom functions to replace complex commands or commands that are difficult to constrain in JEA.</span></span> <span data-ttu-id="b0b8d-120">Egy egyszerű függvény, amely egy összetett parancsot csomagol vagy további érvényesítési logikát alkalmaz, további vezérlést biztosíthat a rendszergazdák és a végfelhasználók egyszerűsége érdekében.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-120">A simple function that wraps a complex command or applies additional validation logic can offer additional control for admins and end-user simplicity.</span></span>
5. <span data-ttu-id="b0b8d-121">**Tesztelje** az engedélyezett parancsok hatókörű listáját a felhasználókkal vagy az Automation szolgáltatásokkal, és szükség esetén módosítsa azokat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-121">**Test** the scoped list of allowable commands with your users or automation services, and adjust as necessary.</span></span>

### <a name="examples-of-potentially-dangerous-commands"></a><span data-ttu-id="b0b8d-122">Példák a potenciálisan veszélyes parancsokra</span><span class="sxs-lookup"><span data-stu-id="b0b8d-122">Examples of potentially dangerous commands</span></span>

<span data-ttu-id="b0b8d-123">A parancsok körültekintő kiválasztása fontos annak biztosítása érdekében, hogy a JEA-végpont ne engedélyezze a felhasználónak az engedélyeik kiterjesztését.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-123">Careful selection of commands is important to ensure the JEA endpoint doesn't allow the user to elevate their permissions.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b0b8d-124">A JEA-munkamenet felhasználói successCommands szükséges alapvető információk gyakran emelt szintű jogosultságokkal futnak.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-124">Essential information required for user successCommands in a JEA session are often run with elevated privileges.</span></span>

<span data-ttu-id="b0b8d-125">A következő táblázat példákat tartalmaz olyan parancsokra, amelyek rosszindulatúan használhatók, ha nem korlátozott állapotban engedélyezettek.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-125">The following table contains examples of commands that can be used maliciously if allowed in an unconstrained state.</span></span> <span data-ttu-id="b0b8d-126">Ez a lista nem teljes, és csak figyelmeztető kiindulási pontként használható.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-126">This isn't an exhaustive list and should only be used as a cautionary starting point.</span></span>

|                                            <span data-ttu-id="b0b8d-127">Kockázat</span><span class="sxs-lookup"><span data-stu-id="b0b8d-127">Risk</span></span>                                            |                                <span data-ttu-id="b0b8d-128">Példa</span><span class="sxs-lookup"><span data-stu-id="b0b8d-128">Example</span></span>                                |                                                                              <span data-ttu-id="b0b8d-129">Kapcsolódó parancsok</span><span class="sxs-lookup"><span data-stu-id="b0b8d-129">Related commands</span></span>                                                                              |
| ------------------------------------------------------------------------------------------ | --------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="b0b8d-130">A felhasználó rendszergazdai jogosultságának megadása a JEA megkerüléséhez</span><span class="sxs-lookup"><span data-stu-id="b0b8d-130">Granting the connecting user admin privileges to bypass JEA</span></span>                                | `Add-LocalGroupMember -Member 'CONTOSO\jdoe' -Group 'Administrators'` | <span data-ttu-id="b0b8d-131">`Add-ADGroupMember`, `Add-LocalGroupMember`, `net.exe`, `dsadd.exe`</span><span class="sxs-lookup"><span data-stu-id="b0b8d-131">`Add-ADGroupMember`, `Add-LocalGroupMember`, `net.exe`, `dsadd.exe`</span></span>                                                                                                        |
| <span data-ttu-id="b0b8d-132">Tetszőleges programkód, például kártevők, biztonsági rések vagy egyéni parancsfájlok futtatása a védelem megkerüléséhez</span><span class="sxs-lookup"><span data-stu-id="b0b8d-132">Running arbitrary code, such as malware, exploits, or custom scripts to bypass protections</span></span> | `Start-Process -FilePath '\\san\share\malware.exe'`                   | <span data-ttu-id="b0b8d-133">`Start-Process`, `New-Service`, `Invoke-Item`, `Invoke-WmiMethod`, `Invoke-CimMethod`, `Invoke-Expression`, `Invoke-Command`, `New-ScheduledTask`, `Register-ScheduledJob`</span><span class="sxs-lookup"><span data-stu-id="b0b8d-133">`Start-Process`, `New-Service`, `Invoke-Item`, `Invoke-WmiMethod`, `Invoke-CimMethod`, `Invoke-Expression`, `Invoke-Command`, `New-ScheduledTask`, `Register-ScheduledJob`</span></span> |

## <a name="create-a-role-capability-file"></a><span data-ttu-id="b0b8d-134">Szerepkör-képesség fájl létrehozása</span><span class="sxs-lookup"><span data-stu-id="b0b8d-134">Create a role capability file</span></span>

<span data-ttu-id="b0b8d-135">A [New-PSRoleCapabilityFile](/powershell/module/microsoft.powershell.core/new-psrolecapabilityfile?view=powershell-6) parancsmaggal létrehozhat egy új PowerShell szerepkör-képesség fájlt.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-135">You can create a new PowerShell role capability file with the [New-PSRoleCapabilityFile](/powershell/module/microsoft.powershell.core/new-psrolecapabilityfile?view=powershell-6) cmdlet.</span></span>

```powershell
New-PSRoleCapabilityFile -Path .\MyFirstJEARole.psrc
```

<span data-ttu-id="b0b8d-136">Az eredményül kapott szerepkör-képesség fájlt úgy kell módosítani, hogy engedélyezze a szerepkörhöz szükséges parancsokat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-136">The resulting role capability file should be edited to allow the commands required for the role.</span></span> <span data-ttu-id="b0b8d-137">A PowerShell súgójának dokumentációja több példát is tartalmaz a fájl konfigurálására.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-137">The PowerShell help documentation contains several examples of how you can configure the file.</span></span>

### <a name="allowing-powershell-cmdlets-and-functions"></a><span data-ttu-id="b0b8d-138">PowerShell-parancsmagok és függvények engedélyezése</span><span class="sxs-lookup"><span data-stu-id="b0b8d-138">Allowing PowerShell cmdlets and functions</span></span>

<span data-ttu-id="b0b8d-139">Ha engedélyezni szeretné, hogy a felhasználók PowerShell-parancsmagokat vagy függvényeket futtassanak, adja hozzá a parancsmagot vagy a függvény nevét a VisibleCmdlets vagy a VisibleFunctions mezőhöz.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-139">To authorize users to run PowerShell cmdlets or functions, add the cmdlet or function name to the VisibleCmdlets or VisibleFunctions fields.</span></span> <span data-ttu-id="b0b8d-140">Ha nem biztos abban, hogy egy parancs parancsmag vagy függvény, futtathatja `Get-Command <name>` a kimenetben, és megtekintheti a **CommandType** tulajdonságot.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-140">If you aren't sure whether a command is a cmdlet or function, you can run `Get-Command <name>` and check the **CommandType** property in the output.</span></span>

```powershell
VisibleCmdlets = 'Restart-Computer', 'Get-NetIPAddress'
```

<span data-ttu-id="b0b8d-141">Előfordulhat, hogy egy adott parancsmag vagy függvény hatóköre túl széles a felhasználói igények kielégítéséhez.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-141">Sometimes the scope of a specific cmdlet or function is too broad for your users' needs.</span></span> <span data-ttu-id="b0b8d-142">A DNS-rendszergazda például valószínűleg csak a DNS-szolgáltatás újraindításához van szükség.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-142">A DNS admin, for example, probably only needs access to restart the DNS service.</span></span> <span data-ttu-id="b0b8d-143">A több-bérlős környezetekben a bérlők hozzáférhetnek az önkiszolgáló felügyeleti eszközökhöz.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-143">In multi-tenant environments, tenants have access to self-service management tools.</span></span> <span data-ttu-id="b0b8d-144">A bérlőket a saját erőforrásaik kezelésére kell korlátozni.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-144">Tenants should be limited to managing their own resources.</span></span> <span data-ttu-id="b0b8d-145">Ilyen esetekben korlátozhatja, hogy mely paraméterek legyenek elérhetők a parancsmagból vagy a függvényből.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-145">For these cases, you can restrict which parameters are exposed from the cmdlet or function.</span></span>

```powershell
VisibleCmdlets = @{ Name = 'Restart-Computer'; Parameters = @{ Name = 'Name' }}
```

<span data-ttu-id="b0b8d-146">A fejlettebb forgatókönyvek esetében előfordulhat, hogy korlátozni kell azokat az értékeket is, amelyeket a felhasználók használhatnak ezekkel a paraméterekkel.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-146">In more advanced scenarios, you may also need to restrict the values a user may use with these parameters.</span></span> <span data-ttu-id="b0b8d-147">A szerepkör-képességek lehetővé teszik értékek vagy reguláris kifejezési minta definiálását, amely meghatározza, hogy milyen bevitelre van lehetőség.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-147">Role capabilities let you define a set of values or a regular expression pattern that determine what input is allowed.</span></span>

```powershell
VisibleCmdlets = @{ Name = 'Restart-Service'; Parameters = @{ Name = 'Name'; ValidateSet = 'Dns', 'Spooler' }},
                 @{ Name = 'Start-Website'; Parameters = @{ Name = 'Name'; ValidatePattern = 'HR_*' }}
```

> [!NOTE]
> <span data-ttu-id="b0b8d-148">A [Common PowerShell-paraméterek](/powershell/module/microsoft.powershell.core/about/about_commonparameters) mindig engedélyezve vannak, még akkor is, ha korlátozza az elérhető paramétereket.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-148">The [common PowerShell parameters](/powershell/module/microsoft.powershell.core/about/about_commonparameters) are always allowed, even if you restrict the available parameters.</span></span>
> <span data-ttu-id="b0b8d-149">Ezeket a paramétereket a parameters (paraméterek) mezőben nem szabad explicit módon listázni.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-149">You should not explicitly list them in the Parameters field.</span></span>

<span data-ttu-id="b0b8d-150">Az alábbi táblázat ismerteti a látható parancsmagok vagy függvények testreszabásának különböző módszereit.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-150">The table below describes the various ways you can customize a visible cmdlet or function.</span></span>
<span data-ttu-id="b0b8d-151">A **VisibleCmdlets** mezőben a lent láthatók közül bármelyiket összekeverheti és egyeztetheti.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-151">You can mix and match any of the below in the **VisibleCmdlets** field.</span></span>

|                                           <span data-ttu-id="b0b8d-152">Példa</span><span class="sxs-lookup"><span data-stu-id="b0b8d-152">Example</span></span>                                           |                                                             <span data-ttu-id="b0b8d-153">Használati eset</span><span class="sxs-lookup"><span data-stu-id="b0b8d-153">Use case</span></span>                                                              |
| ------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| <span data-ttu-id="b0b8d-154">`'My-Func'` vagy `@{ Name = 'My-Func' }`</span><span class="sxs-lookup"><span data-stu-id="b0b8d-154">`'My-Func'` or `@{ Name = 'My-Func' }`</span></span>                                                      | <span data-ttu-id="b0b8d-155">Lehetővé teszi, hogy a `My-Func` felhasználó a paraméterek korlátozása nélkül fusson.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-155">Allows the user to run `My-Func` without any restrictions on the parameters.</span></span>                                                      |
| `'MyModule\My-Func'`                                                                        | <span data-ttu-id="b0b8d-156">Lehetővé teszi a felhasználó számára `My-Func` , hogy a `MyModule` paraméterek korlátozása nélkül fusson a modulból.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-156">Allows the user to run `My-Func` from the module `MyModule` without any restrictions on the parameters.</span></span>                           |
| `'My-*'`                                                                                    | <span data-ttu-id="b0b8d-157">Lehetővé teszi, hogy a felhasználó bármely parancsmagot vagy függvényt `My`futtasson a művelettel.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-157">Allows the user to run any cmdlet or function with the verb `My`.</span></span>                                                                 |
| `'*-Func'`                                                                                  | <span data-ttu-id="b0b8d-158">Lehetővé teszi, hogy a felhasználó bármilyen parancsmagot vagy függvényt `Func`futtasson a főnévi kapcsolatban.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-158">Allows the user to run any cmdlet or function with the noun `Func`.</span></span>                                                               |
| `@{ Name = 'My-Func'; Parameters = @{ Name = 'Param1'}, @{ Name = 'Param2' }}`              | <span data-ttu-id="b0b8d-159">Lehetővé teszi, hogy a `My-Func` felhasználó a `Param1` és `Param2` a paraméterekkel fusson.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-159">Allows the user to run `My-Func` with the `Param1` and `Param2` parameters.</span></span> <span data-ttu-id="b0b8d-160">A paraméterekhez bármilyen értéket megadhat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-160">Any value can be supplied to the parameters.</span></span>          |
| `@{ Name = 'My-Func'; Parameters = @{ Name = 'Param1'; ValidateSet = 'Value1', 'Value2' }}` | <span data-ttu-id="b0b8d-161">Lehetővé teszi, hogy a `My-Func` felhasználó a `Param1` paraméterrel fusson.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-161">Allows the user to run `My-Func` with the `Param1` parameter.</span></span> <span data-ttu-id="b0b8d-162">Csak a "érték1" és a "érték2" adható meg a paraméterhez.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-162">Only "Value1" and "Value2" can be supplied to the parameter.</span></span>        |
| `@{ Name = 'My-Func'; Parameters = @{ Name = 'Param1'; ValidatePattern = 'contoso.*' }}`    | <span data-ttu-id="b0b8d-163">Lehetővé teszi, hogy a `My-Func` felhasználó a `Param1` paraméterrel fusson.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-163">Allows the user to run `My-Func` with the `Param1` parameter.</span></span> <span data-ttu-id="b0b8d-164">A "contoso" kezdetű értékek a paraméterhez is megadhatók.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-164">Any value starting with "contoso" can be supplied to the parameter.</span></span> |

> [!WARNING]
> <span data-ttu-id="b0b8d-165">A legjobb biztonsági gyakorlatok esetében nem ajánlott helyettesítő karaktereket használni a látható parancsmagok vagy függvények definiálásához.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-165">For best security practices, it is not recommended to use wildcards when defining visible cmdlets or functions.</span></span> <span data-ttu-id="b0b8d-166">Ehelyett explicit módon fel kell sorolnia az egyes megbízható parancsokat, hogy az azonos elnevezési sémával rendelkező más parancsok ne legyenek szándékosan engedélyezve.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-166">Instead, you should explicitly list each trusted command to ensure no other commands that share the same naming scheme are unintentionally authorized.</span></span>

<span data-ttu-id="b0b8d-167">**ValidatePattern** és **ValidateSet** nem alkalmazható ugyanarra a parancsmagra vagy függvényre.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-167">You can't apply both a **ValidatePattern** and **ValidateSet** to the same cmdlet or function.</span></span>

<span data-ttu-id="b0b8d-168">Ha így tesz, a **ValidatePattern** felülbírálja a **ValidateSet**.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-168">If you do, the **ValidatePattern** overrides the **ValidateSet**.</span></span>

<span data-ttu-id="b0b8d-169">A **ValidatePattern**kapcsolatos további információkért tekintse meg [a következőt: *Hey, Scripting Guy!* post](https://devblogs.microsoft.com/scripting/validate-powershell-parameters-before-running-the-script/) és a [PowerShell reguláris kifejezések](/powershell/module/microsoft.powershell.core/about/about_regular_expressions) hivatkozási tartalma.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-169">For more information about **ValidatePattern**, check out [this *Hey, Scripting Guy!* post](https://devblogs.microsoft.com/scripting/validate-powershell-parameters-before-running-the-script/) and the [PowerShell Regular Expressions](/powershell/module/microsoft.powershell.core/about/about_regular_expressions) reference content.</span></span>

### <a name="allowing-external-commands-and-powershell-scripts"></a><span data-ttu-id="b0b8d-170">Külső parancsok és PowerShell-parancsfájlok engedélyezése</span><span class="sxs-lookup"><span data-stu-id="b0b8d-170">Allowing external commands and PowerShell scripts</span></span>

<span data-ttu-id="b0b8d-171">Annak engedélyezéséhez, hogy a felhasználók végrehajtható fájlokat és PowerShell-parancsfájlokat (. ps1) futtassanak egy JEA-munkamenetben, hozzá kell adnia a **VisibleExternalCommands** mezőben szereplő összes program teljes elérési útját.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-171">To allow users to run executables and PowerShell scripts (.ps1) in a JEA session, you have to add the full path to each program in the **VisibleExternalCommands** field.</span></span>

```powershell
VisibleExternalCommands = 'C:\Windows\System32\whoami.exe', 'C:\Program Files\Contoso\Scripts\UpdateITSoftware.ps1'
```

<span data-ttu-id="b0b8d-172">Ha lehetséges, a PowerShell-parancsmag vagy a függvény egyenértékű funkciójának használata bármely olyan külső végrehajtható fájlhoz, amelyet Ön engedélyez, mivel a PowerShell-parancsmagokkal és-függvényekkel engedélyezett paramétereket szabályozhatja.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-172">Where possible, to use PowerShell cmdlet or function equivalents for any external executables you authorize since you have control over the parameters allowed with PowerShell cmdlets and functions.</span></span>

<span data-ttu-id="b0b8d-173">Számos végrehajtható fájl lehetővé teszi az aktuális állapot olvasását, majd a különböző paraméterek megadásával történő módosítását.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-173">Many executables allow you to read the current state and then change it by providing different parameters.</span></span>

<span data-ttu-id="b0b8d-174">Vegyünk például egy olyan fájlkiszolgáló-rendszergazda szerepkörét, amely felügyeli a rendszeren tárolt hálózati megosztásokat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-174">For example, consider the role of a file server admin that manages network shares hosted on a system.</span></span> <span data-ttu-id="b0b8d-175">A megosztások kezelésének egyik módja a `net share`használata.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-175">One way of managing shares is to use `net share`.</span></span> <span data-ttu-id="b0b8d-176">A **net. exe** engedélyezése azonban veszélyes, mert a felhasználó a paranccsal rendszergazdai jogosultságokat `net group Administrators unprivilegedjeauser /add`szerezhet a alkalmazással.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-176">However, allowing **net.exe** is dangerous because the user could use the command to gain admin privileges with `net group Administrators unprivilegedjeauser /add`.</span></span> <span data-ttu-id="b0b8d-177">A biztonságosabb megoldás a [Get-SmbShare](/powershell/module/smbshare/get-smbshare)engedélyezése, amely ugyanazt az eredményt éri el, de sokkal korlátozottabb hatókörrel rendelkezik.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-177">A more secure option is to allow [Get-SmbShare](/powershell/module/smbshare/get-smbshare), which achieves the same result but has a much more limited scope.</span></span>

<span data-ttu-id="b0b8d-178">Ha a JEA-munkamenetben elérhetővé teszi a külső parancsokat a felhasználók számára, mindig adja meg a végrehajtható fájl teljes elérési útját.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-178">When making external commands available to users in a JEA session, always specify the complete path to the executable.</span></span> <span data-ttu-id="b0b8d-179">Ez megakadályozza a rendszeren máshol található, hasonló névvel ellátott és potenciálisan kártékony programok végrehajtását.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-179">This prevents the execution of similarly named and potentially malicious programs located elsewhere on the system.</span></span>

### <a name="allowing-access-to-powershell-providers"></a><span data-ttu-id="b0b8d-180">A PowerShell-szolgáltatók hozzáférésének engedélyezése</span><span class="sxs-lookup"><span data-stu-id="b0b8d-180">Allowing access to PowerShell providers</span></span>

<span data-ttu-id="b0b8d-181">Alapértelmezés szerint nem érhetők el PowerShell-szolgáltatók a JEA-munkamenetekben.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-181">By default, no PowerShell providers are available in JEA sessions.</span></span> <span data-ttu-id="b0b8d-182">Ez csökkenti a kapcsolódó felhasználó felé irányuló bizalmas információk és konfigurációs beállítások kockázatát.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-182">This reduces the risk of sensitive information and configuration settings being disclosed to the connecting user.</span></span>

<span data-ttu-id="b0b8d-183">Ha szükséges, a `VisibleProviders` parancs használatával engedélyezheti a PowerShell-szolgáltatók elérését.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-183">When necessary, you can allow access to the PowerShell providers using the `VisibleProviders` command.</span></span> <span data-ttu-id="b0b8d-184">A szolgáltatók teljes listájáért futtassa a parancsot `Get-PSProvider`.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-184">For a full list of providers, run `Get-PSProvider`.</span></span>

```powershell
VisibleProviders = 'Registry'
```

<span data-ttu-id="b0b8d-185">A fájlrendszer, a beállításjegyzék, a tanúsítványtároló vagy más érzékeny szolgáltatók hozzáférését igénylő egyszerű feladatokhoz érdemes lehet olyan egyéni függvényt írni, amely együttműködik a szolgáltatóval a felhasználó nevében.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-185">For simple tasks that require access to the file system, registry, certificate store, or other sensitive providers, consider writing a custom function that works with the provider on the user's behalf.</span></span> <span data-ttu-id="b0b8d-186">A JEA-munkamenetekben elérhető függvények, parancsmagok és külső programok nem vonatkoznak ugyanazokra a korlátozásokra, mint a JEA.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-186">The functions, cmdlets, and external programs available in a JEA session aren't subject to the same constraints as JEA.</span></span> <span data-ttu-id="b0b8d-187">Alapértelmezés szerint bármely szolgáltatóhoz hozzáférhetnek.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-187">They can access any provider by default.</span></span> <span data-ttu-id="b0b8d-188">Érdemes megfontolni a [felhasználói meghajtó](session-configurations.md#user-drive) használatát is, ha a fájlokat egy JEA-végpontra másol, vagy ha a fájlt átmásolja.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-188">Also consider using the [user drive](session-configurations.md#user-drive) when copying files to or from a JEA endpoint is required.</span></span>

### <a name="creating-custom-functions"></a><span data-ttu-id="b0b8d-189">Egyéni függvények létrehozása</span><span class="sxs-lookup"><span data-stu-id="b0b8d-189">Creating custom functions</span></span>

<span data-ttu-id="b0b8d-190">A szerepkör-képességi fájlban egyéni függvények hozhatók létre, amelyek egyszerűbbé teszik a végfelhasználók összetett feladatait.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-190">You can author custom functions in a role capability file to simplify complex tasks for your end users.</span></span> <span data-ttu-id="b0b8d-191">Az egyéni függvények akkor is hasznosak, ha speciális érvényesítési logikára van szükség a parancsmag paramétereinek értékeihez.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-191">Custom functions are also useful when you require advanced validation logic for cmdlet parameter values.</span></span> <span data-ttu-id="b0b8d-192">Az egyszerű függvények a **FunctionDefinitions** mezőben is írhatók:</span><span class="sxs-lookup"><span data-stu-id="b0b8d-192">You can write simple functions in the **FunctionDefinitions** field:</span></span>

```powershell
VisibleFunctions = 'Get-TopProcess'

FunctionDefinitions = @{
    Name = 'Get-TopProcess'

    ScriptBlock = {
        param($Count = 10)

        Get-Process | Sort-Object -Property CPU -Descending |
            Microsoft.PowerShell.Utility\Select-Object -First $Count
    }
}
```

> [!IMPORTANT]
> <span data-ttu-id="b0b8d-193">Ne felejtse el felvenni az egyéni függvények nevét a **VisibleFunctions** mezőbe, hogy a JEA-felhasználók is futtathatják őket.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-193">Don't forget to add the name of your custom functions to the **VisibleFunctions** field so they can be run by the JEA users.</span></span>

<span data-ttu-id="b0b8d-194">Az egyéni függvények törzse (szkript blokkja) a rendszer alapértelmezett nyelvi módjában fut, és nem a JEA nyelvi korlátozásai vonatkoznak rá.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-194">The body (script block) of custom functions runs in the default language mode for the system and isn't subject to JEA's language constraints.</span></span> <span data-ttu-id="b0b8d-195">Ez azt jelenti, hogy a függvények hozzáférhetnek a fájlrendszerhez és a beállításjegyzékhez, és futtathatnak olyan parancsokat, amelyek nem láthatók a szerepkör-képesség fájljában.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-195">This means that functions can access the file system and registry, and run commands that weren't made visible in the role capability file.</span></span> <span data-ttu-id="b0b8d-196">Ügyeljen arra, hogy ne futtasson tetszőleges kódot paraméterek használatakor.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-196">Take care to avoid running arbitrary code when using parameters.</span></span> <span data-ttu-id="b0b8d-197">Kerülje a felhasználói adatbevitelt közvetlenül olyan parancsmagokra, mint például `Invoke-Expression`a.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-197">Avoid piping user input directly into cmdlets like `Invoke-Expression`.</span></span>

<span data-ttu-id="b0b8d-198">A fenti példában azt láthatja, hogy a teljes modul neve (FQMN) `Microsoft.PowerShell.Utility\Select-Object` a Gyorsírás `Select-Object`helyett lett használva.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-198">In the above example, notice that the fully qualified module name (FQMN) `Microsoft.PowerShell.Utility\Select-Object` was used instead of the shorthand `Select-Object`.</span></span>
<span data-ttu-id="b0b8d-199">A szerepkör-képesség fájljaiban definiált függvények továbbra is a JEA-munkamenetek hatókörét képezik, amely tartalmazza a JEA által a meglévő parancsok korlátozására létrehozott proxy-függvényeket.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-199">Functions defined in role capability files are still subject to the scope of JEA sessions, which includes the proxy functions JEA creates to constrain existing commands.</span></span>

<span data-ttu-id="b0b8d-200">Alapértelmezés `Select-Object` szerint a egy korlátozott parancsmag az összes JEA-munkamenetben, amely nem teszi lehetővé az objektumok tetszőleges tulajdonságainak kijelölését.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-200">By default, `Select-Object` is a constrained cmdlet in all JEA sessions that doesn't allow the selection of arbitrary properties on objects.</span></span> <span data-ttu-id="b0b8d-201">A `Select-Object` nem korlátozás nélküli függvények használatához explicit módon kell megadnia a teljes implementációt a FQMN használatával.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-201">To use the unconstrained `Select-Object` in functions, you must explicitly request the full implementation using the FQMN.</span></span> <span data-ttu-id="b0b8d-202">A JEA-munkamenetekben a korlátozott parancsmagok megegyeznek a függvények hívásakor felmerülő korlátozásokkal.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-202">Any constrained cmdlet in a JEA session has the same constraints when invoked from a function.</span></span> <span data-ttu-id="b0b8d-203">További információ: [about_Command_Precedence](/powershell/module/microsoft.powershell.core/about/about_command_precedence).</span><span class="sxs-lookup"><span data-stu-id="b0b8d-203">For more information, see [about_Command_Precedence](/powershell/module/microsoft.powershell.core/about/about_command_precedence).</span></span>

<span data-ttu-id="b0b8d-204">Ha több egyéni függvényt ír, érdemes lehet őket egy PowerShell-parancsfájl modulba helyezni.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-204">If you're writing several custom functions, it's more convenient to put them in a PowerShell script module.</span></span> <span data-ttu-id="b0b8d-205">Ezeket a függvényeket a JEA-munkamenetben láthatja a **VisibleFunctions** mezővel, például a beépített és a külső gyártótól származó modulok esetén.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-205">You make those functions visible in the JEA session using the **VisibleFunctions** field like you would with built-in and third-party modules.</span></span>

<span data-ttu-id="b0b8d-206">Ahhoz, hogy a TAB Befejezés megfelelően működjön a JEA-munkamenetekben, bele kell foglalni `tabexpansion2` a beépített függvényt a **VisibleFunctions** listába.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-206">For tab completion to work properly in JEA sessions you must include the built-in function `tabexpansion2` in the **VisibleFunctions** list.</span></span>

## <a name="place-role-capabilities-in-a-module"></a><span data-ttu-id="b0b8d-207">Szerepkör-képességek elhelyezése egy modulban</span><span class="sxs-lookup"><span data-stu-id="b0b8d-207">Place role capabilities in a module</span></span>

<span data-ttu-id="b0b8d-208">Ahhoz, hogy a PowerShell megtalálja a szerepkör-képességi fájlt, a PowerShell-modul **RoleCapabilities** mappájában kell tárolni.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-208">In order for PowerShell to find a role capability file, it must be stored in a **RoleCapabilities** folder in a PowerShell module.</span></span> <span data-ttu-id="b0b8d-209">A modul a `$env:PSModulePath` környezeti változóban található bármelyik mappában tárolható, azonban ne helyezze azt a system32 vagy egy olyan mappába, ahol a nem megbízható, a csatlakozó felhasználók módosíthatják a fájlokat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-209">The module can be stored in any folder included in the `$env:PSModulePath` environment variable, however you shouldn't place it in System32 or a folder where the untrusted, connecting users could modify the files.</span></span> <span data-ttu-id="b0b8d-210">Az alábbi példa egy **ContosoJEA** nevű alapszintű PowerShell-parancsfájl-modul létrehozását `$env:ProgramFiles` mutatja be az elérési úton.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-210">Below is an example of creating a basic PowerShell script module called **ContosoJEA** in the `$env:ProgramFiles` path.</span></span>

```powershell
# Create a folder for the module
$modulePath = Join-Path $env:ProgramFiles "WindowsPowerShell\Modules\ContosoJEA"
New-Item -ItemType Directory -Path $modulePath

# Create an empty script module and module manifest.
# At least one file in the module folder must have the same name as the folder itself.
New-Item -ItemType File -Path (Join-Path $modulePath "ContosoJEAFunctions.psm1")
New-ModuleManifest -Path (Join-Path $modulePath "ContosoJEA.psd1") -RootModule "ContosoJEAFunctions.psm1"

# Create the RoleCapabilities folder and copy in the PSRC file
$rcFolder = Join-Path $modulePath "RoleCapabilities"
New-Item -ItemType Directory $rcFolder
Copy-Item -Path .\MyFirstJEARole.psrc -Destination $rcFolder
```

<span data-ttu-id="b0b8d-211">A PowerShell-modulokkal kapcsolatos további információkért lásd [a PowerShell-modul ismertetése](/powershell/developer/windows-powershell)című témakört.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-211">For more information about PowerShell modules, see [Understanding a PowerShell Module](/powershell/developer/windows-powershell).</span></span>

## <a name="updating-role-capabilities"></a><span data-ttu-id="b0b8d-212">Szerepkör-képességek frissítése</span><span class="sxs-lookup"><span data-stu-id="b0b8d-212">Updating role capabilities</span></span>

<span data-ttu-id="b0b8d-213">A szerepkör-képesség fájl szerkesztésével bármikor frissítheti a beállításokat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-213">You can edit a role capability file to update the settings at any time.</span></span> <span data-ttu-id="b0b8d-214">A szerepkör-képesség frissítése után elindított új JEA-munkamenetek tükrözik a felülvizsgált képességeket.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-214">Any new JEA sessions started after the role capability has been updated will reflect the revised capabilities.</span></span>

<span data-ttu-id="b0b8d-215">Ezért fontos a szerepkör-képességek mappához való hozzáférés szabályozása.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-215">This is why controlling access to the role capabilities folder is so important.</span></span> <span data-ttu-id="b0b8d-216">Csak a nagyon megbízható rendszergazdák módosíthatják a szerepkör-képesség fájljait.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-216">Only highly trusted administrators should be allowed to change role capability files.</span></span> <span data-ttu-id="b0b8d-217">Ha egy nem megbízható felhasználó megváltoztathatja a szerepkör-képesség fájljait, egyszerűen hozzáférhetnek olyan parancsmagokhoz, amelyek lehetővé teszik számukra a jogosultságuk kiterjesztését.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-217">If an untrusted user can change role capability files, they can easily give themselves access to cmdlets that allow them to elevate their privileges.</span></span>

<span data-ttu-id="b0b8d-218">Ahhoz, hogy a rendszergazdák le tudjanak zárni a szerepkör-képességekhez való hozzáférést, győződjön meg arról, hogy a helyi rendszer rendelkezik olvasási hozzáféréssel a szerepkör-képesség fájljaihoz és a modulokhoz.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-218">For administrators looking to lock down access to the role capabilities, ensure Local System has read access to the role capability files and containing modules.</span></span>

## <a name="how-role-capabilities-are-merged"></a><span data-ttu-id="b0b8d-219">A szerepkör-képességek egyesítése</span><span class="sxs-lookup"><span data-stu-id="b0b8d-219">How role capabilities are merged</span></span>

<span data-ttu-id="b0b8d-220">A felhasználók hozzáférést kapnak a [munkamenet-konfigurációs fájl](session-configurations.md) összes megfelelő szerepkör-képességéhez, amikor belépnek egy JEA-munkamenetbe.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-220">Users are granted access to all matching role capabilities in the [session configuration file](session-configurations.md) when they enter a JEA session.</span></span> <span data-ttu-id="b0b8d-221">A JEA megpróbálja megadni a felhasználónak az egyik szerepkör által engedélyezett legszigorúbb parancsokat.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-221">JEA tries to give the user the most permissive set of commands allowed by any of the roles.</span></span>

### <a name="visiblecmdlets-and-visiblefunctions"></a><span data-ttu-id="b0b8d-222">VisibleCmdlets és VisibleFunctions</span><span class="sxs-lookup"><span data-stu-id="b0b8d-222">VisibleCmdlets and VisibleFunctions</span></span>

<span data-ttu-id="b0b8d-223">A legösszetettebb egyesítési logika a parancsmagokat és a függvényeket is érinti, amelyek paramétereit és paramétereit a JEA korlátozhatja.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-223">The most complex merge logic affects cmdlets and functions, which can have their parameters and parameter values limited in JEA.</span></span>

<span data-ttu-id="b0b8d-224">A szabályok a következők:</span><span class="sxs-lookup"><span data-stu-id="b0b8d-224">The rules are as follows:</span></span>

1. <span data-ttu-id="b0b8d-225">Ha egy parancsmag csak egyetlen szerepkörben látható, akkor a felhasználó a megfelelő paraméterekkel megkötésekkel látható.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-225">If a cmdlet is only made visible in one role, it is visible to the user with any applicable parameter constraints.</span></span>
2. <span data-ttu-id="b0b8d-226">Ha egy parancsmag több szerepkörben is látható, és mindegyik szerepkör ugyanazokkal a korlátozásokkal rendelkezik a parancsmagon, akkor a parancsmag látható a felhasználó számára ezekkel a korlátozásokkal.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-226">If a cmdlet is made visible in more than one role, and each role has the same constraints on the cmdlet, the cmdlet is visible to the user with those constraints.</span></span>
3. <span data-ttu-id="b0b8d-227">Ha egy parancsmag több szerepkörben is látható, és az egyes szerepkörök különböző paramétereket tesznek lehetővé, a parancsmag és az összes szerepkörben definiált összes paraméter látható a felhasználó számára.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-227">If a cmdlet is made visible in more than one role, and each role allows a different set of parameters, the cmdlet and all the parameters defined across every role are visible to the user.</span></span>
   <span data-ttu-id="b0b8d-228">Ha egy szerepkör nem tartalmaz korlátozásokat a paraméterekhez, az összes paraméter engedélyezve lesz.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-228">If one role doesn't have constraints on the parameters, all parameters are allowed.</span></span>
4. <span data-ttu-id="b0b8d-229">Ha az egyik szerepkör egy validate set vagy validate mintát határoz meg egy parancsmag-paraméterhez, és a másik szerepkör lehetővé teszi, hogy a paraméter értéke ne korlátozza a paramétereket, a rendszer figyelmen kívül hagyja az érvényesítési készletet vagy a mintát.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-229">If one role defines a validate set or validate pattern for a cmdlet parameter, and the other role allows the parameter but does not constrain the parameter values, the validate set or pattern is ignored.</span></span>
5. <span data-ttu-id="b0b8d-230">Ha egy érvényesítési készlet egynél több szerepkörben ugyanahhoz a parancsmag-paraméterhez van definiálva, az összes érvényesítési csoport összes értéke engedélyezett.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-230">If a validate set is defined for the same cmdlet parameter in more than one role, all values from all validate sets are allowed.</span></span>
6. <span data-ttu-id="b0b8d-231">Ha egy érvényesítési minta egynél több szerepkörben ugyanahhoz a parancsmag-paraméterhez van definiálva, akkor az egyik mintázatnak megfelelő értékek engedélyezettek.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-231">If a validate pattern is defined for the same cmdlet parameter in more than one role, any values that match any of the patterns are allowed.</span></span>
7. <span data-ttu-id="b0b8d-232">Ha egy érvényesítési csoport egy vagy több szerepkörben van definiálva, és egy érvényesítési minta van definiálva egy másik szerepkörben ugyanahhoz a parancsmag-paraméterhez, az érvényesítési csoport figyelmen kívül lesz hagyva, és a szabály (6) a fennmaradó érvényesítési mintákra vonatkozik.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-232">If a validate set is defined in one or more roles, and a validate pattern is defined in another role for the same cmdlet parameter, the validate set is ignored and rule (6) applies to the remaining validate patterns.</span></span>

<span data-ttu-id="b0b8d-233">Az alábbi példa bemutatja, hogyan történik a szerepkörök egyesítése a szabályoknak megfelelően:</span><span class="sxs-lookup"><span data-stu-id="b0b8d-233">Below is an example of how roles are merged according to these rules:</span></span>

```powershell
# Role A Visible Cmdlets
$roleA = @{
    VisibleCmdlets = 'Get-Service',
                     @{ Name = 'Restart-Service';
                        Parameters = @{ Name = 'DisplayName'; ValidateSet = 'DNS Client' } }
}

# Role B Visible Cmdlets
$roleB = @{
    VisibleCmdlets = @{ Name = 'Get-Service';
                        Parameters = @{ Name = 'DisplayName'; ValidatePattern = 'DNS.*' } },
                     @{ Name = 'Restart-Service';
                        Parameters = @{ Name = 'DisplayName'; ValidateSet = 'DNS Server' } }
}

# Resulting permissions for a user who belongs to both role A and B
# - The constraint in role B for the DisplayName parameter on Get-Service
#   is ignored because of rule #4
# - The ValidateSets for Restart-Service are merged because both roles use
#   ValidateSet on the same parameter per rule #5
$mergedAandB = @{
    VisibleCmdlets = 'Get-Service',
                     @{ Name = 'Restart-Service';
                        Parameters = @{ Name = 'DisplayName'; ValidateSet = 'DNS Client', 'DNS Server' } }
}
```

### <a name="visibleexternalcommands-visiblealiases-visibleproviders-scriptstoprocess"></a><span data-ttu-id="b0b8d-234">VisibleExternalCommands, VisibleAliases, VisibleProviders, ScriptsToProcess</span><span class="sxs-lookup"><span data-stu-id="b0b8d-234">VisibleExternalCommands, VisibleAliases, VisibleProviders, ScriptsToProcess</span></span>

<span data-ttu-id="b0b8d-235">A szerepkör-képesség fájl összes többi mezője elérhető külső parancsok, aliasok, szolgáltatók és indítási parancsfájlok összesített készletéhez lesz hozzáadva.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-235">All other fields in the role capability file are added to a cumulative set of allowable external commands, aliases, providers, and startup scripts.</span></span> <span data-ttu-id="b0b8d-236">Az egyik szerepkör-funkcióban elérhető bármely parancs, alias, szolgáltató vagy parancsfájl elérhető a JEA-felhasználó számára.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-236">Any command, alias, provider, or script available in one role capability is available to the JEA user.</span></span>

<span data-ttu-id="b0b8d-237">Ügyeljen arra, hogy az egyik szerepkör-képességből és-parancsmagokból/függvényből/parancsokból álló kombinált szolgáltatók ne engedélyezzék a felhasználók számára a rendszererőforrásokhoz való véletlen hozzáférést.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-237">Be careful to ensure that the combined set of providers from one role capability and cmdlets/functions/commands from another don't allow users unintentional access to system resources.</span></span>
<span data-ttu-id="b0b8d-238">Ha például az egyik szerepkör engedélyezi a `Remove-Item` parancsmagot, és egy másik engedélyezi a `FileSystem` szolgáltatót, akkor a JEA-felhasználó a számítógépen tetszőleges fájlokat törölhet.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-238">For example, if one role allows the `Remove-Item` cmdlet and another allows the `FileSystem` provider, you are at risk of a JEA user deleting arbitrary files on your computer.</span></span> <span data-ttu-id="b0b8d-239">A felhasználók hatékony engedélyeinek azonosításával kapcsolatos további információkért tekintse meg a [naplózás JEA](audit-and-report.md) szóló cikket.</span><span class="sxs-lookup"><span data-stu-id="b0b8d-239">Additional information about identifying users' effective permissions can be found in the [auditing JEA](audit-and-report.md) article.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b0b8d-240">További lépések</span><span class="sxs-lookup"><span data-stu-id="b0b8d-240">Next steps</span></span>

[<span data-ttu-id="b0b8d-241">Munkamenet-konfigurációs fájl létrehozása</span><span class="sxs-lookup"><span data-stu-id="b0b8d-241">Create a session configuration file</span></span>](session-configurations.md)
